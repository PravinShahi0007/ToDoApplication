var dd=(todayDate=new Date).getDate(),mm=todayDate.getMonth()+1,yyyy=todayDate.getFullYear();dd<10&&(dd="0"+dd),mm<10&&(mm="0"+mm);var todayDate,ItmTypKy=0,ControlConKy=0,ConrlConKy=0,ItmEANKy=0,ItmCat7Ky=0,ItmCat8Ky=0,FormGlblData={FormObjData:null,AllDefalutValueObj:null,ItmKy:1,ItmTypKy:1,TrnTypKy:1,AccessLvlKy:1,ConfiLvlKy:1,gridIndex:1,FinItmKy:1,TodayDate:todayDate=dd+"/"+mm+"/"+yyyy};function GetFormObjData1(){$.ajax({url:urlUsrObjPrp_SelectAllLastChildWeb,dataType:"json",type:"POST",data:JSON.stringify({PrntKy:viewBag.ObjKy}),contentType:"application/json; charset=utf-8",success:function(t){FormGlblData.FormObjData=t,FormGlblData.AllDefalutValueObj=Get_AllDefalutValue_Obj(),DocReadyCus1()}})}function DocReadyCus1(){LoadCombo(),ItemGridDefaultColumns()}function setHdrSectionPropFun(){setHdrSectionProp("",viewBag.ObjKy,"","HdrSec1"),SetHandlingEnterKeyEvent("",viewBag.ObjKy),SetFirstFocusObj()}function LoadCombo(){$("#HdrSec1_CmbTyp_Cd").kendoComboBox({dataValueField:"CdKy",dataTextField:"CdNm",dataSource:CdNm_SelectMob_Datasource("HdrSec1_CmbTyp"),filter:"contains",suggest:!0,placeholder:"Select Item Type.."}),$("#HdrSec1_CmbDept_Cd").kendoComboBox({dataValueField:"CdKy",dataTextField:"CdNm",dataSource:CdNm_SelectMob_Datasource("HdrSec1_CmbDept"),change:function(t){GetCat8ByCat7_SelectWeb()},filter:"contains",suggest:!0,placeholder:"Select a Dept.."}),$("#HdrSec1_CmbCat_Cd").kendoComboBox({dataValueField:"CdKy",dataTextField:"CdNm",dataSource:CdNm_SelectMob_Datasource("HdrSec1_CmbCat"),change:function(t){},filter:"contains",suggest:!0,placeholder:"Select Category.."})}function GetControlConKy(){$.ajax({url:urlGetControlConKy,data:JSON.stringify({TblNm:"ItmMasCd",OurCd:"ItmMasCdInvLoc"}),contentType:"application/json; charset=utf-8",dataType:"Json",type:"POST",success:function(t){ControlConKy=t}})}function GetControlCnKy(){$.ajax({url:urlGetControlConKyForItmRate,data:JSON.stringify({TblNm:"ItmRate",OurCd:"ItmRateItmSale"}),contentType:"application/json; charset=utf-8",dataType:"Json",type:"POST",success:function(t){ConrlConKy=t},error:function(t){return!1}})}function GetCat8ByCat7_SelectWeb(){var t=$("#HdrSec1_CmbDept_Cd").data("kendoComboBox").value();$("#HdrSec1_CmbCat_Cd").data("kendoComboBox").value(null),1!=t&&""!=t?$.ajax({url:urlGetCat8ByCat7_SelectWeb,dataType:"json",type:"POST",data:JSON.stringify({Cat7Ky:t}),contentType:"application/json; charset=utf-8",success:function(t){$("#HdrSec1_CmbCat_Cd").kendoComboBox({dataValueField:"CdKy",dataTextField:"CdNm",dataSource:t,filter:"contains",suggest:!0,placeholder:"Select Category.."});$("#HdrSec1_CmbCat_Cd").data("kendoComboBox").value()}}):$("#HdrSec1_CmbCat_Cd").kendoComboBox({dataValueField:"CdKy",dataTextField:"CdNm",dataSource:CdNm_SelectMob_Datasource("HdrSec1_CmbCat"),change:function(t){},filter:"contains",suggest:!0,placeholder:"Select Category.."})}function Clear(){$("#HdrSec1_InptItmCd_Val").val(null),$("#HdrSec1_InptItmNm_Val").val(null),$("#HdrSec1_CmbDept_Cd").data("kendoComboBox").value(null),$("#HdrSec1_CmbCat_Cd").data("kendoComboBox").value(null);ItmKy=$("#ItmKy").val(1),Clear_AllDefalutValue_Obj()}function Save(){var t=$(".tabstrip").kendoTabStrip().data("kendoTabStrip");if(null!=t){var e;if(-1==(e=t.select().index())){for(var a=(r=$("#Itemgrid").data("kendoGrid")).dataSource.data(),o=[],n=[],d=0;d<a.length;d++)a[d].isNew()?n.push(a[d].toJSON()):a[d].dirty&&o.push(a[d].toJSON());0!=n.length||0!=o.length?$.ajax({url:urlInsert,dataType:"json",type:"POST",data:JSON.stringify({NewGridDetail:kendo.stringify(n),updateGrid:kendo.stringify(o)}),contentType:"application/json; charset=utf-8",success:function(t){1==t?alert("Saved Successfully"):(alert("Record Not Saved"),LoadItemGridView(ItmTypKy))},error:function(t){return!1}}):$.ajax({url:urlUpdate,dataType:"json",type:"POST",data:JSON.stringify({NewGridDetail:kendo.stringify(n),updateGrid:kendo.stringify(o)}),contentType:"application/json; charset=utf-8",success:function(t){1==t?alert("Saved Successfully"):(alert("Record Not Updated"),LoadItemGridView(ItmTypKy))},error:function(t){return!1}})}else if(2==e)SaveMultiUnitDet();else if(0==e){var r=$("#ItmSettingsgrid").data("kendoGrid"),i=$("#ItmKy").val();for(a=r.dataSource.data(),o=[],n=[],d=0;d<a.length;d++)a[d].dirty&&n.push(a[d].toJSON());0!=n.length&&$.ajax({url:urlInsertItmSettings,dataType:"json",type:"POST",data:JSON.stringify({NewGridDetail:kendo.stringify(n),ItmKy:i,ControlConKy:ControlConKy,ObjKy:viewBag.ObjKy}),contentType:"application/json; charset=utf-8",success:function(t){1==t?(alert("Successfully Saved"),LoadItmSettingsGrid()):(alert("Record Not Saved"),LoadItmSettingsGrid())},error:function(t){return!1}})}else if(1==e){i=$("#ItmKy").val();$("#HdrSec1_CmbTyp_Cd").data("kendoComboBox").value();for(a=(r=$("#Pricegrid").data("kendoGrid")).dataSource.data(),o=[],n=[],d=0;d<a.length;d++)a[d].isNew()?n.push(a[d].toJSON()):a[d].dirty&&o.push(a[d].toJSON());0==n.length&&0==o.length||$.ajax({url:urlUpdatePriceRevision,data:JSON.stringify({updateGrid:kendo.stringify(o),newGrid:kendo.stringify(n),ControlConKy:ConrlConKy,ItmKy:i,ObjKy:viewBag.ObjKy}),contentType:"application/json; charset=utf-8",dataType:"Json",type:"POST",success:function(t){1==t?(alert("Successfully Saved..!"),LoadPriceGrid()):(alert("Record Not Saved"),LoadPriceGrid())},error:function(t){return!1}})}}else alert("There is no item to save")}function Add(){tabStrip=-1;var t=$("#Itemgrid").data("kendoGrid");t&&t.addRow()}function ImportItem(){var t=document.location.host,e=viewBag.ObjCaptn,a=viewBag.OurCd,o=viewBag.ObjKy,n="http://"+t+"/"+RootDir+"/ItmPrfl/ItmMasExcelImport?ObjCaptn="+e+"&OurCd="+a+"&OurCd2=&ObjKy="+o;window.open(n,"_blank")}function Post(){$.ajax({url:urlUpdatePost,dataType:"json",type:"POST",data:JSON.stringify({}),contentType:"application/json; charset=utf-8",success:function(t){1==t?alert("Saved Successfully"):alert("Record Not Updated")},error:function(t){return!1}})}$(document).ready(function(){$.ajax({url:urlCodes.GetCdKyByConCdAndOurCd,dataType:"json",type:"POST",data:JSON.stringify({ObjKy:viewBag.ObjKy,ConCd:"ItmTyp",OurCd:viewBag.OurCd}),contentType:"application/json; charset=utf-8",success:function(t){FormGlblData.ItmTypKy=t,GetFormObjData1()}})}),$("#Itemgrid").on("dblclick","tr.k-state-selected",function(){var t=$("#Itemgrid").data().kendoGrid,e=t.dataItem(t.select()),a=e.LiNo,o=e.ItmKy,n=e.ItmTypKy,d=e.ItmTaxKy,r=e.ItmCd,i=e.ItmNm;ItmCat7Ky=e.ItmCat7Ky,$("#HdrSec1_InptItmCd_Val").val(r),$("#HdrSec1_InptItmNm_Val").val(i),$("#HdrSec1_CmbDept_Cd").data("kendoComboBox").value(ItmCat7Ky),GetCat8ByCat7_SelectWeb();e.Brand,e.Vat,e.EAN;ItmCat8Ky=e.ItmCat8Ky;var l=e.Cat8Cd,c=e.Cat7Cd,s=(e.isAlwTrnRateChange,e.isAgeVarification,e.isAct,e.ItmDisplayNm,e.GrpInv,e.ItmTaxCatKy,e.UnitKy,e.Image,e.ImageUpload,e.FileName);if(1!=a){$("#TempLiNumber").value=a,$("#HdrSec1_CmbDept_Nm").val(c),$("#HdrSec1_CmbCat_Nm").val(l),$("#HdrSec1_CmbTyp_Cd").data("kendoComboBox").value(n),$("#ItmKy").val(o),$("#ItmTaxKy").val(d);var u=$("<img>",{src:"data:image/png;base64,"+s,width:"70px",height:"90px"});$("#imagePreview").empty(),$("#imagePreview").append(u),$("#HdrSec1_CmbCat_Cd").data("kendoComboBox").value(ItmCat8Ky),$("#window").removeClass("hidden"),$("#window").kendoWindow({width:"75%",height:"70%",title:"Edit",visible:!1,actions:["Pin","Minimize","Maximize","Close"]}).data("kendoWindow").center().open(),$(".tabstrip").kendoTabStrip({animation:{open:{effects:"fadeIn"}}}),$(".tabstrip").data("kendoTabStrip").select(0),ItmSettingsTab(),LoadItmSettingsGrid(),LoadPriceGrid(),LoadItmStockGrid(),$("#HdrSec1_InptItmKy_Val").val(o)}else alert("You Cannot change the Line Number one")});