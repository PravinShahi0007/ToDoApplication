function LoadAfterOneMinuteTrnTypPendingOrdTyp(){var n=new Date,t=n.getDate(),i,r;t==0&&(t=01);i=n.getMonth()+1;r=n.getFullYear();$("#TrnTypOrd_FrmDateFromPR").val(t+"/"+i+"/"+r);LoadComboFind_Form_FindFromPurReq();LoadGridFindView_Form_FindFromPurReq();var u=$(window).height()-70,f=$("#filterCont").height();$("#body").height(u);$("#grid").height(u-(35+f+40))}function ProjectDataSource(){return new kendo.data.DataSource({transport:{read:{url:urlComboLoad.PrjIdFromTrnTypPendingOrdTyp,dataType:"json"}}})}function SupDatasource(){return new kendo.data.DataSource({transport:{read:{url:'@Url.Content("~/Order/GetSuplistForOrder")',dataType:"json"}}})}function LoadComboFind_Form_FindFromPurReq(){$("#TrnTypOrd_cmbSupGRN").kendoComboBox({dataValueField:"AccKy",dataTextField:"AccCd",dataSource:SupDatasource(),filter:"contains",suggest:!0,placeholder:"Select a suplier.."});$("#TrnTypOrd_OrdtypOrdcmbSupGRN").kendoComboBox({dataValueField:"AccKy",dataTextField:"AccCd",dataSource:SupDatasource(),filter:"contains",suggest:!0,placeholder:"Select a suplier.."});$("#TrnTypOrd_cmbPrjectIdFrmPurReq").kendoComboBox({dataValueField:"PrjKy",dataTextField:"PrjID",dataSource:ProjectDataSource(),filter:"contains",suggest:!0,placeholder:"Select a Project.."})}function LoadGridFindView_Form_FindFromPurReq(){var n=new kendo.data.DataSource({batch:!0,pageSize:10,schema:{model:{id:"ItmKy",fields:{Lino:{editable:!1,nullable:!1,type:"number"},OrdKy:{editable:!1,nullable:!1,type:"number"},Prefix:{editable:!1,nullable:!1,type:"number"},Supplier:{editable:!1,nullable:!1,type:"string"},OrdNo:{editable:!1,nullable:!1,type:"number"},OrdDt:{editable:!1,nullable:!1,type:"date"},DocNo:{editable:!1,nullable:!1,type:"string"}}}}});$("#TrnTypOrd_FindFromPOGrid").kendoGrid({dataSource:n,autobind:!0,navigatable:!0,filterable:{mode:"row"},pageable:!0,sortable:!0,reorderable:!0,columnMenu:!0,selectable:"row",pageable:{refresh:!0,pageSizes:[5,10,20,50,100]},columns:[{field:"Lino",title:"LiNo",width:"50px"},{field:"OrdKy",title:"Ref #",width:"100px",hidden:!0},{field:"Prefix",title:"Prefix",width:"150px"},{field:"Supplier",title:"Supplier",width:"150px"},{field:"OrdNo",title:"OrdNo",width:"150px"},{field:"OrdDt",title:"OrdDt",width:"100px",format:"{0: MM-dd-yyyy}",template:"#= kendo.toString(kendo.parseDate(OrdDt, 'yyyy-MM-dd'), 'MM/dd/yyyy') #"},{field:"DocNo",title:"DocNo",width:"150px"},],resizable:!0,dataBinding:function(){record=(this.dataSource.page()-1)*this.dataSource.pageSize()},editable:!0})}function SearchPurOrd(){var f,n,e,t,r,u,o,s;$("#TrnTypOrd_FindFromPOGrid").data("kendoGrid").dataSource.filter(null);f=$("#TrnTypOrd_FindFromPOGrid").data("kendoGrid");f.dataSource.data([]);n=$("#TrnTypOrd_cmbPrjectIdFrmPurReq").data("kendoComboBox").value();(n==undefined||n==""||n==null)&&(n=1);e=1;t=$("#TrnTypOrd_FrmDateFromPR").val();(t==undefined||t==""||t==null)&&(t="1/1/1900");r=$("#TrnTypOrd_ToDateFromPR").val();(r==undefined||r==""||r==null)&&(r="1/1/2078");u=document.getElementById("TrnTypOrd_OrdNoFrmPurReq").value;(u==undefined||u==""||u==null)&&(u=1);o="OrdTyp";s=OurForFind;$.ajax({url:URLGetFromPurOrd.LoadFindGrid,data:JSON.stringify({PrjKy:n,SupKy:e,ConCd:o,OurCd:s,FrmDt:t,ToDt:r,ToOrdNo:u,TrnTypKy:FormGlblData.TrnTypKy}),contentType:"application/json; charset=utf-8",dataType:"Json",type:"POST",success:function(n){for(i=0;i<n.length;i++)$("#TrnTypOrd_FindFromPOGrid").data("kendoGrid").dataSource.add({Lino:n[i].Lino,OrdKy:n[i].OrdKy,Prefix:n[i].Prefix,Supplier:n[i].SupAccCd,OrdNo:n[i].OrdNo,OrdDt:new Date(n[i].OrdDt),DocNo:n[i].DocNo})},error:function(){return!1}})}function CancelPurOrd(){$("#TrnTypOrd_FindFromPOGrid").data("kendoGrid").dataSource.data([]);$("#TrnTypOrd_ToDateFromPR").data("kendoDatePicker").value("");$("#TrnTypOrd_cmbPrjectIdFrmPurReq").data("kendoComboBox").value("")}function GetDetailsFromPurOrd(n){var t=OurForFind;$.ajax({url:URLGetFromPurOrd.GettingAllRecords,data:JSON.stringify({ordKy:n,ConCd:"OrdTyp",OurCd:t}),contentType:"application/json; charset=utf-8",dataType:"Json",type:"POST",success:function(n){var e="",t,o,s,h,c,r,u,f,l,a,i,v;if(n.length>0){for(t=0,o=n[t].OrdKy,$("#OrdKy").val(o),e+=n[t].OrdDetKy+" ",s=n[t].PrefixTrnNo,$("#POrdNo").val(s),h=n[t].YurRef,$("#HdrSec1_InptYurRef_Val").val(h),c=n[t].DocNo,$("#HdrSec1_InptDocNo_Val").val(c),$("#HdrSec1_DatPicDate_Val").data("kendoDatePicker").value(n[t].OrdDt),r=n[t].PrjKy,$("#HdrSec2_CmbToPrj_Cd").data("kendoComboBox").value(r),$("#HdrSec2_CmbToPrj_Nm").data("kendoComboBox").value(r),u=n[t].LocKy2,$("#HdrSec2_CmbFrmLoc_Cd").data("kendoComboBox").value(u),$("#HdrSec2_CmbFrmLoc_Nm").data("kendoComboBox").value(u),f=n[t].LocKy,$("#HdrSec2_CmbToLoc_Cd").data("kendoComboBox").value(f),$("#HdrSec2_CmbToLoc_Nm").data("kendoComboBox").value(f),l=n[t].Des,$("#HdrSec6_InptDesc_Val").val(l),a=n[t].Rem,$("#HdrSec6_InptRemark_Val").val(a),$("#OrdDetKy").val(e),i="#"+viewBag.OurCd,$(i).data("kendoGrid").dataSource.filter(null),v=$(i).data("kendoGrid"),v.dataSource.data([]),t=0;t<n.length;t++)$(i).data("kendoGrid").dataSource.add({OrdNo:n[t].LiNo,OrdDetKy:n[t].OrdDetKy,ItmKy:n[t].ItmKy,LiNo:n[t].LiNo,ItmCd:n[t].ItmCd,ItmNm:n[t].ItmNm,Unit:n[t].Unit,UnitKy:n[t].UnitKy,Des:n[t].DetDes,DisAmt:n[t].TrnDisAmt,DisPer:n[t].DisPer,Rem:n[t].DetRem,POQty:n[t].BaseQty,ReMnQty:n[t].OrdrdQty,TrnQty:n[t].OrdrdQty,TrnRate:n[t].TrnRate,SubTotal:n[t].TrnRate*n[t].TrnQty,GrossTotal:n[t].TrnRate*n[t].TrnQty-n[t].TrnDisAmt,NetTotal:n[t].TrnRate*n[t].TrnQty-n[t].TrnDisAmt+n[t].VatAmt+n[t].WHTAmt+n[t].NBTAmt+n[t].SVatAmt,VatAmt:n[t].VatAmt,WHTAmt:n[t].WHTAmt,NBTAmt:n[t].NBTAmt,SVatAmt:n[t].SVatAmt,VAT:n[t].VAT,WHT:n[t].WHT,NBT:n[t].NBT,SVAT:n[t].SVAT,ReqDt:n[t].ReqDt,IsAct:n[t].isAct,AvlStk:n[t].AvlStk,IsAlwMinusStk:n[t].IsAlwMinusStk});$("#GetFromPurOrd").data("kendoWindow").close();Calculatetotal()}},error:function(){return!1}})}function TrnTypOrdTypSelect(n,t){TrnTypOrdTypSelect_GetFromPurOrd_IsOpen&&(LoadAfterOneMinuteTrnTypPendingOrdTyp(),TrnTypOrdTypSelect_GetFromPurOrd_IsOpen=!1);var i="Get From ".concat(t);(t=="PO"||t=="po")&&(i="Get From Purchase Order");(t=="SLSORD"||t=="SlsOrd")&&(i="Get From Sales Order");$("#GetFromPurOrd").show().kendoWindow({width:"1000px",height:"550px",modal:!0,title:i});OurForFind=t;$("#GetFromPurOrd").data("kendoWindow").center().open()}$("#TrnTypOrd_FrmDateFromPR").width(150).kendoDatePicker({format:"dd/MM/yyyy",min:new Date(31,2,2009)});$("#TrnTypOrd_FrmDateFromPR").closest("span.k-datepicker").width(150);$("#TrnTypOrd_ToDateFromPR").width(150).kendoDatePicker({format:"dd/MM/yyyy",min:new Date(31,2,2009)});$("#TrnTypOrd_ToDateFromPR").closest("span.k-datepicker").width(150);$("#TrnTypOrd_FindFromPOGrid").on("dblclick","tr.k-state-selected",function(){var t=$("#TrnTypOrd_FindFromPOGrid").data().kendoGrid,i=t.dataItem(t.select()),n=i.OrdKy;n!=""||n!=undefined||n!=null?GetDetailsFromPurOrd(n):alert("please Select Any Trancsaction");CancelPurOrd()});var TrnTypOrdTypSelect_GetFromPurOrd_IsOpen=!0;